# recon
spring batch for finance reconciliation

## 业务场景
财务系统每月都需要从不同合作机构拿到订单文件（包括订单号，金额），和交易系统中的进行对比，并结算。这个项目的目的就是启动一个对账任务，记录对账结果。对账的逻辑如下：
* 读取合作机构提供的excel。如果excel中订单号或者金额字段为空或者不符合规范，对账失败。如果excel中保单号重复，对账失败。记录下导致失败的订单以及失败原因到错误文件中。
* 通过excel中的保单号从订单表中取得对应的保单。
* 如果订单表中不存在记录，在对账差异文件中记录差异原因，三方有我方无。
* 如果订单表中只有一条记录，如果金额一致，在订单表更新订单批次id。如果金额不一致，在对账差异文件中记录差异原因，金额不一致。无论是否一致，更新订单状态为对账中。
* 如果订单表中有多条记录，找到金额同excel一致的订单组合，如果未找到，在对账差异文件记录差异原因，金额不一致。如果找到了，在订单表更新这个组合订单批次id，同时将其余的订单记录到对账差异文件中，差异原因，我方有三方无。不管结果怎么样，设置这些订单状态为对账中。


## 流程图

```sequence
A->B: how are you?
B-->>A: fine.
```
